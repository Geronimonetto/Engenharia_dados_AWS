"""
Trecho de código 01: Transformando os dados do arquivo actors.csv para dicionário, onde a chave será o nome do ator
e os Values serão todos os dados desse ator

"""
def data_transform():
    with open("actors.csv", "r", encoding="utf-8") as arquivo:
        for values in arquivo:
            list_clear = []
            data_clear = {}
            for index, data in enumerate(arquivo):
                data = data.replace(", ","")
                data = data.rstrip()
                data = data.replace("\n", "")
                data = data.split(",")
                list_clear.append(data)
                if index + 1 == len(list_clear):
                    data_clear[list_clear[index][0]] = list_clear[index][1:]
                else:
                    break
        return data_clear


"""
Trecho de código 02: Organizando os dados para verificação de quantidade de filmes

"""
def data_organized(data_clear):
    organized_list = []
    for valor in data_clear.items():
        organized_list.append(valor[0])
        organized_list.append(valor[1][1])
    return organized_list

"""
Trecho de código 03: Pegandos a quantidade de filmes do ator e o nome para verificar qual a maior quantidade de filmes por ator.

"""
def data_verify(organized_list):
    data_actor = []
    maior = 0
    nome = ""

    for data_types in organized_list:
        if data_types.isnumeric():
            data_types = int(data_types)
            data_actor.append(data_types)
            if data_types > maior:
                maior = data_types
                nome = data_actor[data_actor.index(data_types) - 1]

        else:
            data_actor.append(data_types)
    return f"O Ator com maior número de filmes foi {nome} com {maior} Filmes"

if __name__ == "__main__":
    print(data_verify(data_organized(data_transform())))
